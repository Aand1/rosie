########################################################################
# 
# Elaborate: category (block or location)
#
########################################################################
sp {topstate*elaborate*category-info
   (state <s> ^topstate <s>)
-->
   (<s> ^agent-info <agent-info>)
   (<agent-info> ^object-category-info <info>
                 ^bin-info <bin-info>)
   (<info> ^table location
           ^garbage location
           ^pantry location
           ^stove location
           ^scale location
           ^thermometer location
           ^home location
           ^goal location
           ^open-spot location
           ^bin-1 bin
           ^bin-2 bin
           ^bin-3 bin
           ^bin-4 bin
           ^bin-5 bin
           ^bin-6 bin
           ^grid-1 location
           ^grid-2 location
           ^grid-3 location
           ^grid-4 location
           ^grid-5 location
           ^grid-6 location
           ^grid-7 location
           ^grid-8 location
           ^grid-9 location
           ^grid-10 location
           ^grid-11 location
           ^grid-12 location
           ^grid-red location
           ^grid-orange location
           ^grid-yellow location
           ^grid-green location
           ^grid-blue location
           ^yellow-grid location
           ^green-grid location
           ^blue-grid location
           ^blocker-1 blocker
           ^blocker-2 blocker
           ^blocker-3 blocker)
   (<bin-info> ^blocking-info <b1> <b2> <b3>)
   (<b1> ^bin bin-1
         ^blocker blocker-1)
   (<b2> ^bin bin-2
         ^blocker blocker-2)
   (<b3> ^bin bin-3
         ^blocker blocker-3)
}

sp {topstate*elaborate*object*category
   (state <s> ^topstate <s>
              ^agent-info.object-category-info <info>
              ^object <obj>)
   (<obj> ^property <prop>)
   (<prop> ^name name
           ^word <name>)
   (<info> ^<name> <cat>)
-->
   (<obj> ^category <cat>)
}

sp {topstate*elaborate*object*category*default
   (state <s> ^topstate <s>
              ^agent-info.object-category-info <info>
              ^object <obj>)
   (<obj> ^property <prop>)
   (<prop> ^name name
           ^word <name>)
   (<info> -^<name>)
-->
   (<obj> ^category block)
}

sp {topstate*elaborate*bin*blocker
   (state <s> ^topstate <s>
              ^agent-info.bin-info.blocking-info <info>
              ^object <bin>
              ^object <blocker>)
   (<info> ^bin <bin-name>
           ^blocker <blocker-name>)
   (<bin> ^property <bin-prop>)
   (<bin-prop> ^name name
               ^word <bin-name>)
   (<blocker> ^property <blocker-prop>)
   (<blocker-prop> ^name name
                   ^word <blocker-name>)
-->
   (<bin> ^blocker <blocker>)
}

sp {topstate*elaborate*bin*open*no*blocker
   (state <s> ^topstate <s>
              ^object <bin>)
   (<bin> ^category bin
         -^blocker)
-->
   (<bin> ^open true)
}

sp {topstate*elaborate*bin*open*blocker*disabled
   (state <s> ^topstate <s>
              ^object <bin>)
   (<bin> ^category bin
          ^blocker.property <prop>)
   (<prop> ^name enabled
           ^label false)
-->
   (<bin> ^open true)
}

sp {topstate*elaborate*bin*closed*blocker*enabled
   (state <s> ^topstate <s>
              ^object <bin>)
   (<bin> ^category bin
          ^blocker.property <prop>)
   (<prop> ^name enabled
           ^label true)
-->
   (<bin> ^open false)
}

sp {topstate*input-link*elaborate*object*name
   (state <s> ^topstate <s>
              ^io.input-link.objects.object <obj>)
   (<obj> ^property <prop>)
   (<prop> ^name name
           ^values.<name> <conf>)
-->
   (<obj> ^name <name>)
}

sp {topstate*input-link*elaborate*object*int-id
   (state <s> ^topstate <s>
              ^io.input-link.objects.object <obj>)
   (<obj> ^id <id>)
-->
   (<obj> ^int-id (int <id>))
}

#### as locations
#sp {elaborate*objects*locations
#   (state <s> ^topstate <s>)
#   (<s> ^object <obj>)
#   (<obj> ^property.word << table garbage pantry stove scale thermometer home bin1 bin2 bin3 grid1 grid2 grid3 grid4 grid5 grid6 grid7 grid8 grid9 grid10 grid11 grid12 grid-red grid-yellow grid-orange grid-blue grid-green >>)
#-->
#   (<obj> ^category location)
#}
#
#### as blocks
#sp {elaborate*objects*blocks
#   (state <s> ^topstate <s>)
#   (<s> ^object <obj>)
#   (<obj> -^property.word << table garbage pantry stove scale thermometer home bin1 bin2 bin3 grid1 grid2 grid3 grid4 grid5 grid6 grid7 grid8 grid9 grid10 grid11 grid12 grid-red grid-yellow grid-orange grid-blue grid-green >>)
#-->
#   (<obj> ^category block)
#}

#######################################
#
# Default Name
#
#######################################
sp {elaborate*object*default*name
   (state <s> ^topstate <s>
              ^object <obj>)
   (<obj> ^property <name>)
   (<name> ^name name
          -^value.word <> object)
-->
   (<name> ^value.word object)
}   
   
sp {elaborate*object*shape*name
   (state <s> ^topstate <s>
              ^object <obj>)
   (<obj> ^property <shape>
          ^property <name>)
   (<shape> ^name shape
            ^word <l>)
   (<name> ^name name
          -^value.given)
-->
   (<name> ^value.word <l>)
}

######################################
#
# Confidences
#
######################################
# Uses the confidence information to give a estimate of how accurate the visual label is
sp {elaborate*visual-properties*confidences*high
   (state <s> ^topstate <s>
              ^object.property.value <value>)
   (<value> ^confidence-value > .7)
-->
   (<value> ^confidence high)
}

sp {elaborate*visual-properties*confidences*medium
   (state <s> ^topstate <s>
              ^object.property.value <value>)
   (<value> ^confidence-value <= .7 > .3)
-->
   (<value> ^confidence medium)
}

sp {elaborate*visual-properties*confidences*low
   (state <s> ^topstate <s>
              ^object.property.value <value>)
   (<value> ^confidence-value < .3)
-->
   (<value> ^confidence low)
}

########################################
#
# Unambiguous words/labels
#
########################################

sp {elaborate*object*property*word
   (state <s> ^topstate <s>
              ^object.property <prop>)
   (<prop> ^value.word <word>)
-->
   (<prop> ^word <word>)
}

sp {elaborate*object*property*label
   (state <s> ^topstate <s>
              ^object.property <prop>)
   (<prop> ^value.label <label>)
-->
   (<prop> ^label <label>)
}

########################################################################
# 
# Elaborate: linguistic-desc
#
########################################################################
sp {elaborate*object*linguistic-desc
   (state <s> ^topstate <s>
              ^object <obj>)
-->
   (<obj> ^linguistic-desc <desc>)
}

sp {elaborate*object*linguistic-desc*word
   (state <s> ^topstate <s>
              ^object <obj>)
   (<obj> ^linguistic-desc <desc>
          ^property <name>)
   (<name> ^name name
           ^word <word>)
-->
   (<desc> ^word <word>)
}

sp {elaborate*object*linguistic-desc*adjective
   (state <s> ^topstate <s>
              ^object <obj>)
   (<obj> ^linguistic-desc <desc>
          ^property <prop>)
   (<prop> ^type << visual measurable >>
           ^word <word>)
   (<desc> -^word <word>)
-->
   (<desc> ^adjective <word>)
}



########################################################################
#
# Elaborate: smem-rep
#
########################################################################

sp {elaborate*object*smem-rep*adjective
   (state <s> ^topstate <s>
              ^object <obj>)
   (<obj> ^smem-rep <rep>
          ^property.word <word>)
-->
   (<rep> ^adjective <word>)
}

sp {topstate*apply*any-op*store-in-smem
   (state <s> ^topstate <s>
              ^object <obj>
              ^operator <o>
              ^smem.command <cmd>)
   (<obj> ^store-in-smem true
          ^smem-rep <rep>)
-->
   (<cmd> ^store <rep>)
   (<obj> ^store-in-smem true -)
}


### elaborate table as flat
sp {elaborate*table*flat
   (state <s> ^topstate <s>
   	      ^object <obj>)
   (<obj> ^property.label table)
-->
   (<obj> ^property <prop>)
   (<prop> ^label flat
   	   ^name volume)
}

sp {elaborate*others*container
   (state <s> ^topstate <s>
   	      ^object <obj>)
   (<obj> ^property <prop>)
   (<prop> ^name name
   	   ^label {<l> <> table})
-->
   (<obj> ^property <prop-n>)
   (<prop-n> ^label container
   	   ^name volume)
}

sp {elaborate*block*closed
   (state <s> ^topstate <s>
   	      ^object <obj>)
   (<obj> ^category block)
-->
   (<obj> ^property <prop-n>)
   (<prop-n> ^label closed
   	   ^name volume)
}

sp {elaborate*object*object-desc
   (state <s> ^topstate <s>
              ^object <obj>)
-->
   (<obj> ^object-desc <desc>)
}

sp {elaborate*object*object-desc*label
   (state <s> ^topstate <s>
              ^object <obj>)
   (<obj> ^object-desc <desc>
          ^property <prop>)
   (<prop> ^name <prop-name>
           ^label <label>)
-->
   (<desc> ^<prop-name> <label>)
}

sp {elaborate*object*object-desc*feature-val
   (state <s> ^topstate <s>
              ^object <obj>)
   (<obj> ^object-desc <desc>
          ^property <prop>)
   (<prop> ^name <prop-name>
           ^feature-val <val>)
-->
   (<desc> ^(concat <prop-name> |-value|) <val>)
}

