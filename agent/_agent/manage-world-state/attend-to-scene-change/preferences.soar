# Reject an attend-to-scene-change operator if attending to an object being moved

#sp {anystate*reject*attend-to-scene-change*moving*object
#   (state <s> ^operator <o> +)
#   (<o> ^name attend-to-scene-change
#        ^change.object-info.wm-obj.predicates.arm-status << moving grabbed >>
#        ^change.type <> changed-object-status)
#-->
#   (<s> ^operator <o> -)
#}

# Ordering of scene change operators

sp {anystate*attend-to-scene-change*prefer*higher*preference-order
   (state <s> ^operator <o1> +
              ^operator <o2> +)
   (<o1> ^name attend-to-scene-change
         ^preference-order <pref1>)
   (<o2> ^name attend-to-scene-change
         ^preference-order < <pref1>)
-->
   (<s> ^operator <o1> > <o2>)
}

sp {anystate*attend-to-scene-change*prefer*equal*same*preference-order
   (state <s> ^operator <o1> +
              ^operator <o2> +)
   (<o1> ^name attend-to-scene-change
         ^preference-order <pref>)
   (<o2> ^name attend-to-scene-change
         ^preference-order <pref>)
-->
   (<s> ^operator <o1> = <o2>)
}

sp {anystate*attend-to-scene-change*elaborate*default*preference-order
   (state <s> ^operator <o> +)
   (<o> ^name attend-to-scene-change
       -^preference-order > 0)
-->
   (<o> ^preference-order 0)
}


# Preference Orders:

# update-object = 200
# delete-object = 200
# arm-status-change = 150
# new-location = 150
# different-moving-state = 150
# stale-object = 100
# shrunken-object = 90
# new-object = 60
# new-object = 50
# grown-object = 40
# moved-object = 30
# new-predicate = 20
# changed-predicate = 20
# status-change = 20
# recheck-occlusion = 10

sp {anystate*scene-change*visibility*preference-order
   (state <s> ^operator <o> +)
   (<o> ^name attend-to-scene-change
        ^change.type << newly-visible-object newly-not-visible-object >>)
-->
   (<o> ^preference-order 300)
}

sp {anystate*scene-change*new-object*preference-order
   (state <s> ^operator <o> +)
   (<o> ^name attend-to-scene-change
        ^change.type new-object)
-->
   (<o> ^preference-order 250)
}

sp {anystate*scene-change*update*delete*object*preference-order
   (state <s> ^operator <o> +)
   (<o> ^name attend-to-scene-change
        ^change.type << update-pose delete-object >>) 
-->
   (<o> ^preference-order 200)
}

sp {anystate*scene-change*robot-changes*preference-order
   (state <s> ^operator <o> +)
   (<o> ^name attend-to-scene-change
        ^change.type << changed-arm-status changed-robot-status changed-waypoint >>)
-->
   (<o> ^preference-order 150)
}

sp {anystate*scene-change*new-stable-object*preference-order
   (state <s> ^operator <o> +)
   (<o> ^name attend-to-scene-change
        ^change.type new-stable-object)
-->
   (<o> ^preference-order 80)
}

#sp {anystate*scene-change*new-object*preference-order
#   (state <s> ^operator <o> +)
#   (<o> ^name attend-to-scene-change
#        ^change.type new-object)
#-->
#   (<o> ^preference-order 60)
#}

sp {anystate*scene-change*missing-object*preference-order
   (state <s> ^operator <o> +)
   (<o> ^name attend-to-scene-change
        ^change.type missing-object)
-->
   (<o> ^preference-order 40)
}

sp {anystate*scene-change*moved-object*preference-order
   (state <s> ^operator <o> +)
   (<o> ^name attend-to-scene-change
        ^change.type moved-object)
-->
   (<o> ^preference-order 30)
}

sp {anystate*scene-change*unary*predicates*preference-order
   (state <s> ^operator <o> +)
   (<o> ^name attend-to-scene-change
        ^change.type << new-object-predicate >>)
-->
   (<o> ^preference-order 20)
}
