# Elaborations for top-state and substates

# name
# Name a state using the selected superstate operator's name
sp {all*elaborate*name
   (state <s> ^superstate.operator.name <name>)
-->
   (<s> ^name <name>)
}

#
#sp {top-state*elaborate*intermediate
#   (state <s> ^superstate nil)
#-->
#   (<s> ^intermediate <int>)
#}


# problem-space
# every state has a problem-space
sp {all*elaborate*problem-space
   (state <s> ^top-state <ts>)
-->
   (<s> ^problem-space <ps>)
}

#sp {all*elaborate*in-focus
#   (state <s> ^top-state <ts>
#              -^problem-space games)
#-->
#   (<s> ^in-focus <if>)
#}


### all states have environments
#sp {all*elaborate*environment
#   (state <s> ^top-state <ts>
#             -^problem-space games)
#-->
#   (<s> ^environment <env>)
#   (<env> ^intermediate <int>)
#}

# top-state
# Copy direct top-state link to all substates
sp {top-state*elaborate*top-state
   (state <s> ^superstate nil)
-->
   (<s> ^top-state <s>)
}

sp {all*elaborate*top-state*top-state
   (state <s> ^superstate.top-state <top>
             -^problem-space.state.dont-copy top-state)
-->
   (<s> ^top-state <top>)
}

sp {evaluate-operator*elaborate*dont-copy*top-state
   (state <s> ^superstate.operator.name evaluate-operator
              ^problem-space <ps>)
-->
   (<ps> ^state.dont-copy top-state)
}

# io
# Copy the io link to all substates
sp {all*elaborate*io
   (state <s> ^superstate.io <io>
             -^problem-space.state.dont-copy io)
#	      -^name selection
#	      -^problem-space.state.dont-copy io
#             -^name learn-param
#             -^name setup-search
#   	      -^name action-policy)
-->
   (<s> ^io <io>)
}

# object
# Copy objects to substate, if not in language problem-space
#sp {all*elaborate*object
#   (state <s> ^superstate <ss>
#      	  -^problem-space << lgsoar message-interpretation >>
#	  -^problem-space.state.dont-copy object
#          -^name learn-param
#          -^name setup-search
#	  -^name selection)
#   (<ss> -^problem-space << lgsoar message-interpretation >>
#   	 ^object <obj>)
#-->
#  (<s> ^object <obj>)
#}

### SM: elaborate ignore-set - useful for matching and prefering actions 

#sp {all*elaborate*ignore-set
#   (state <s> ^problem-space <ps>
#             -^problem-space games)
#-->
#   (<s> ^ignore-set <nm>)
#   (<nm> ^attribute applied
#         ^attribute phase
#   	 ^attribute information
#	 ^attribute _relation
#	 ^attribute _metadata
#	 ^attribute actions
#	 ^attribute action-type
#	 ^attribute matched
#	 ^attribute _instantiation-of
#	 ^attribute op_name)
#}
