# Special rules for the selection space during retrospective learning

#retrospective-learning
#  state-no-change [learn-proposal-rule]
#    op-no-change [composite-action]

sp {action*composite-action*learning*retrospective*elaborate*state*subactions-copy
   (state <s> ^superstate.name learn-proposal-rule
              ^problem-space <ps>)
   (<ps> ^name action
         ^learning.type retrospective
         ^state <state>)
-->
   (<state> ^subactions-copy shallow)
}

sp {action*composite-action*learning*retrospective*elaborate*desired*satisfied*superstate
   (state <s> ^superstate.name learn-proposal-rule
              ^problem-space.name action
              ^problem-space.learning.type retrospective
              ^desired.satisfied true
              ^superstate <ss>)
-->
   (<ss> ^desired.satisfied true)
}

#retrospective-learning
#  state-no-change [learn-proposal-rule]
#    op-no-change [composite-action]
#      operator-tie [selection]

sp {action*selection*learning*retrospective*elaborate*state*subactions-copy
   (state <s> ^name selection
              ^problem-space <ps>)
   (<ps> ^name action
         ^learning.type retrospective
         ^state <state>)
-->
   (<state> ^subactions-copy shallow)
}

sp {action*selection*learning*retrospective*elaborate*learning*use*chunking
   (state <s> ^name selection
              ^problem-space <ps>)
   (<ps> ^name action
         ^learning <learn>)
   (<learn> ^type retrospective)
-->
   (<learn> ^use chunking)
}

sp {action*selection*learning*retrospective*elaborate*current-subaction
   (state <s> ^name selection
              ^problem-space.name action
              ^problem-space.learning.type retrospective
              ^subactions.next <sub>)
-->
   (<s> ^action-to-match <sub>)
}

#retrospective-learning
#  state-no-change [learn-proposal-rule]
#    op-no-change [composite-action]
#      operator-tie [selection]
#        op-no-change [evaluate-operator]

sp {action*evaluate-operator*learning*retrospective*elaborate*state*subactions-copy
   (state <s> ^name evaluate-operator
              ^problem-space <ps>)
   (<ps> ^name action
         ^learning.type retrospective
         ^state <state>)
-->
   (<state> ^subactions-copy deep)
}

sp {retrospective-learning*evaluate-operator*apply*action*advance*subaction
   (state <s> ^name evaluate-operator
              ^look-ahead-operator <o>
              ^operator <o>
              ^subactions <subs>)
   (<subs> ^next <cur>)
   (<cur> ^next <next>)
-->
   (<subs> ^next <cur> -
           ^next <next>)
}
