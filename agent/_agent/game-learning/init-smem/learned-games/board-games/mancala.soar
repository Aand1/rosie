#mancala
#Initialize topstate relationships
sp {elab*top-state*preps*mancala
   (state <s> ^superstate nil
              ^game mancala)
-->
   (<s> ^topstate <s>)
   (<s> ^prepositions <p>)
   (<p> ^prep <p1>
        ^prep <p2>
        ^prep <p3>)
   (<p1> ^name below ^pair <p21>
         ^pair <p22> ^pair <p23>
         ^pair <p24> ^pair <p25>
         ^pair <p26>)
   (<p21> ^b 21 ^a 11)
   (<p22> ^b 22 ^a 11)
   (<p23> ^b 23 ^a 11)
   (<p24> ^b 24 ^a 11)
   (<p25> ^b 25 ^a 13)
   (<p26> ^b 26 ^a 13)
   (<p2> ^name on ^pair <p31>
         ^pair <p32> ^pair <p33>
         ^pair <p34> ^pair <p35>
         ^pair <p36>)
   (<p31> ^a 21 ^b 11)
   (<p32> ^a 22 ^b 11)
   (<p33> ^a 23 ^b 11)
   (<p34> ^a 24 ^b 11)
   (<p35> ^a 25 ^b 13)
   (<p36> ^a 26 ^b 13)
   (<p3> ^name left-of
         ^pair <p51>
         ^pair <p52> 
         ^pair <p53>
         ^pair <p55>
         ^pair <p56>
         ^pair <p61>
         ^pair <p62> 
         ^pair <p63>
         ^pair <p65>
         ^pair <p71>
         ^pair <p72> 
         ^pair <p73>
         ^pair <p81>
         ^pair <p82>
         ^pair <p91>)  
   (<p51> ^a 16 ^b 11)
   (<p52> ^a 16 ^b 12)
   (<p53> ^a 16 ^b 13)
   (<p55> ^a 16 ^b 14)
   (<p56> ^a 16 ^b 15)
   (<p61> ^a 15 ^b 11)
   (<p62> ^a 15 ^b 12)
   (<p63> ^a 15 ^b 13)
   (<p65> ^a 15 ^b 14)
   (<p71> ^a 14 ^b 11)
   (<p72> ^a 14 ^b 12)
   (<p73> ^a 14 ^b 13)
   (<p81> ^a 13 ^b 11)
   (<p82> ^a 13 ^b 12)
   (<p91> ^a 12 ^b 11)
}
#Initialize objects
sp {index-object*object*mancala
   (state <s> ^name index-object
              ^superstate <ss>
              ^topstate.game mancala
              ^superstate.operator <o>)
   (<o> ^word object)
-->
   (<ss> ^result <res>)
   (<res> ^set.item <os>)
   (<os> ^object <o1> ^object <o2>
         ^object <o3> ^object <o4>
         ^object <o1b> ^object <o2b>
         ^object <o14> ^object <o15>
         ^object <o16> ^object <o17>
         ^object <o18> ^object <o19>)
   (<o1> ^id 11 ^type location ^x 1 ^y 1 ^word start)
   (<o2> ^id 12 ^type location ^x 2 ^y 1)
   (<o3> ^id 13 ^type location ^x 3 ^y 1)
   (<o4> ^id 14 ^type location ^x 4 ^y 1)
   (<o1b> ^id 15 ^type location ^x 5 ^y 1)
   (<o2b> ^id 16 ^type location ^x 6 ^y 1)
   (<o14> ^id 21 ^type block ^word black)
   (<o15> ^id 22 ^type block ^word black)
   (<o16> ^id 23 ^type block ^word black)
   (<o17> ^id 24 ^type block ^word black)
   (<o18> ^id 25 ^type block ^word black)
   (<o19> ^id 26 ^type block ^word black)
}


#todo
sp {resolve-conditions*elaborate*mancala-actionz
   (state <s> ^name resolve-conditions
              ^topstate.gtype actionz
              ^topstate.game mancala)
-->
   (<s> ^parameter-set <ps>
        ^condition-set <c6>
        ^condition <c6>
        ^condition-set <c99>
        ^condition <c99>)
   (<ps> ^argnum 5)
   
   (<c4> ^name block ^type attribute ^args <ag8> ^negative false ^parameter.result.link.link.set.object.id holder)
   (<ag8> ^num 1 ^1 <c5>)
   
   (<c99> ^name count ^return-type number ^type evaluator ^args <ag33> ^negative false ^parameter <pp1>)
   #(<pp1> ^result.link <p11z> ^num 1 ^1 <p11z>)
   #(<p11z> ^param-id 4 ^link.set.link.number holder ^type single)
   
   (<pp1> ^result.link <p21bx> ^num 2 ^1 <p21x> ^2 <p21bx>)
   (<p21x> ^param-id 3 ^link.set.pair.a holder ^type set)
   (<p21bx> ^param-id 4 ^link.set.pair.b holder ^type single)

   (<ag33> ^num 1 ^1 <c9>)
   
   (<c9> ^name below ^negative false ^type spatial ^args <ag666> ^parameter <px>)
   (<px> ^num 2 ^1 <p1> ^2 <p2> ^result.link <p2>)
   (<p1> ^param-id 1 ^link.set.pair.a holder ^type single)
   (<p2> ^param-id 3 ^link.set.pair.b holder ^type set)
   (<ag666> ^num 2 ^1 <c2> ^2 <c4>)

   
   (<c2> ^name location ^type attribute ^args <ag3> ^negative false ^parameter.result.link.link.set.object.id holder)
   (<ag3> ^num 1 ^1 <c5>)
   
   (<c6> ^name count ^return-type number ^type evaluator ^args <ag34> ^negative false ^parameter <ppp>)
   (<ppp> ^result.link <p21b> ^num 2 ^1 <p21> ^2 <p21b>)
   (<p21> ^param-id 5 ^link.set.pair.a holder ^type set)
   (<p21b> ^param-id 4 ^link.set.pair.b holder ^type single)
   
   (<ag34> ^num 1 ^1 <c6a>)
   (<c6a> ^name between-inclusive ^negative false ^type spatial ^args <ag11> ^parameter <p3z7>)
   (<p3z7> ^result.link <p11b> ^num 3 ^1 <p11> ^2 <p11a> ^3 <p11b>)
   (<p11b> ^param-id 5 ^link.set.pair.c holder ^type set)
   (<p11> ^param-id 1 ^link.set.pair.a holder ^type single)
   (<p11a> ^param-id 2 ^link.set.pair.b holder ^type single)
   (<ag11> ^num 3 ^1 <c7> ^2 <c8> ^3 <c2>)
   
   (<c8> ^name below ^negative true ^type spatial ^args <ag5> ^parameter <p37>)
   (<p37> ^result.link <p12> ^num 1 ^1 <p12>)
   (<p12> ^param-id 2 ^link.set.object.id holder ^type single)
   (<ag5> ^num 2 ^1 <c2> ^2 <c4>)
   
   (<c7> ^name below ^negative false ^type spatial ^args <ag66> ^parameter <p7>)
   (<p7> ^result.link <p13> ^num 1 ^1 <p13>)# ^2 <p14>)
   (<p13> ^param-id 1 ^link.set.object.id holder ^type single)
  # (<p14> ^param-id 1 ^link.set.pair.b holder ^type single)
   (<ag66> ^num 2 ^1 <c2> ^2 <c4>)
   
   (<c5> ^name object ^type attribute ^args <a1> ^negative false ^parameter.result.link.link.set.object.id holder)
}


sp {resolve-conditions*elaborate*mancala-action
   (state <s> ^name resolve-conditions
              ^topstate.gtype action
              ^topstate.game mancala)
-->
   (<s> ^nlp-set <nlps>)
   (<nlps> ^nlp <c99> 
           ^nlp <c6>)
   
   (<c4> ^name block ^rtype single)
   (<c4s> ^name block ^rtype set)
   
   (<c99> ^name count ^return-type number ^args <ag33> ^parameter <pp1>)  
   (<pp1> ^result.link <p21bx> ^1 <p21x> ^2 <p21bx>)
   (<p21x> ^param-id 3 ^type set)# ^link.set.pair.a holder )#TODO FIX
   (<p21bx> ^param-id 4 ^type single)# ^link.set.pair.b holder ^type single)

   (<ag33> ^1 <c9>)
   
   (<c9> ^name below ^args <ag666> ^parameter <px>)
   (<px> ^1 <p1> ^2 <p2> ^result.link <p2>)
   (<p1> ^param-id 1)
   (<p2> ^param-id 3)
   (<ag666> ^1 <c2> ^2 <c4s>)
   
   (<c2> ^name location ^rtype single)
   (<c2s> ^name location ^rtype set)
   
   (<c6> ^name count ^return-type number ^args <ag34> ^parameter <ppp>)
   (<ppp> ^result.link <p21b> ^1 <p21> ^2 <p21b>)
   (<p21> ^param-id 5 ^type set)# ^link.set.pair.a holder ^type set) #TODO FIX
   (<p21b> ^param-id 4 ^type single)# ^link.set.pair.b holder ^type single)
   
   (<ag34> ^1 <c6a>)
   (<c6a> ^name between-inclusive ^args <ag11> ^parameter <p3z7>)
   (<p3z7> ^result.link <p11b> ^1 <p11> ^2 <p11a> ^3 <p11b>)
   (<p11b> ^param-id 5)
   (<p11> ^param-id 1)
   (<p11a> ^param-id 2)
   (<ag11> ^1 <c7> ^2 <c8> ^3 <c2s>)
   
   (<c8> ^name clear ^args <ag5> ^parameter <p37>)
   (<p37> ^result.link <p12> ^1 <p12>)
   (<p12> ^param-id 2)
   (<ag5> ^1 <c2>)# ^2 <c4>)
   
   (<c7> ^name below ^args <ag66> ^parameter <p7>)
   (<p7> ^result.link <p13> ^1 <p13>)
   (<p13> ^param-id 1)
   (<ag66> ^1 <c2> ^2 <c4>)
}