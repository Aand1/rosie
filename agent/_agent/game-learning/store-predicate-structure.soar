sp {store-predicate-structure*elaborate*attributes
   (state <s> ^name store-predicate-structure
              ^superstate.operator <o>)
   (<o> ^storing <t> ^handle <h> ^message <msg> ^type <y>)
-->
   (<s> ^storing <t> ^handle <h> ^message <msg> ^ptype <y>)
}

sp {store-predicate-structure*elaborate*multiplayer
   (state <s> ^name store-predicate-structure
              ^superstate.operator <o>)
   (<o> ^multiplayer <m>)
-->
   (<s> ^multiplayer <m>)
}


#only store at end
sp {store-predicate-structure*propose*complete
   (state <s> ^name store-predicate-structure)
-->
   (<s> ^operator <o> + =)
   (<o> ^name complete)
}

sp {store-predicate-structure*apply*complete
   (state <s> ^name store-predicate-structure
              ^operator.name complete
              ^top-state.interaction.status <status>
              ^top-state.interaction.changes <changes>)
-->
   (<changes> ^outgoing-message <msg>)
   (<msg> ^type simple-message
          ^message-type ok)
   (<status> ^performed.learning-event <de>)
   (<de> ^type game
         ^originator agent)
   
#  (<M40> ^fields <F31> ^type describe-goal-state)
#    (<F31> ^relationships <G10014>)
#      (<G10014> ^relation <R10800> ^relation <R10801>)
#        (<R10800> ^1 <D1029> ^2 <D1028> ^name on1)
#          (<D1029> ^size large1 ^type block)
#          (<D1028> ^color blue1 ^type location)
#        (<R10801> ^1 <D1028> ^2 <D1029> ^name below1)
}


#TODO REMOVE?
sp {store-predicate-structure*apply*complete*remove-learn-link
   (state <s> ^name store-predicate-structure
              ^operator.name complete
             -^message.predicate <ll>
              ^top-state <ts>)
   (<s> ^storing name)
   (<ts> ^dialog-context <dc>)
   (<dc> ^learn-link <ll>)
-->
   (interrupt)
   (<dc> ^learn-link <ll> -)
}
sp {store-predicate-structure*elaborate*top-state*dialogue-context*game
   (state <s> ^name store-predicate-structure
              ^operator.name complete
              ^top-state <ts>)
   (<s> ^storing name ^ptype game ^handle <handle> ^message.predicate <pred>)
-->
   (<ts> ^dialog-context <dc>)
   (<dc> ^type game-learning ^name <handle> ^structure <pred> ^learning true)
   (<pred> ^actions <act> ^goals <go> ^heuristics <heu>)
   #test learning predicates
#   (<dc> ^learning-predicate <lp>)
#   (<lp> ^name adjacent)
}

sp {store-predicate-structure*elaborate*top-state*dialogue-context*goal
   (state <s> ^name store-predicate-structure
              ^operator.name complete
              ^top-state <ts>)
   (<s> ^storing name ^ptype goal ^handle <handle> ^message.predicate <pred2>)
   (<ts> ^dialog-context <dc>)
   (<dc> ^structure <pred>)
   (<pred> ^goals <go>)
-->
   (<go> ^goal <pred2>)
   (<pred2> ^predicate-structure <ps> ^type goal)
   (<dc> ^learn-link <pred2>)
}

sp {store-predicate-structure*elaborate*top-state*dialogue-context*action
   (state <s> ^name store-predicate-structure
              ^operator.name complete
              ^top-state <ts>)
   (<s> ^storing name ^ptype action ^handle <handle> ^message.predicate <pred2>)
   (<ts> ^dialog-context <dc>)
   (<dc> ^structure <pred>)
   (<pred> ^actions <act>)
-->
   (<act> ^action <pred2>)
   (<pred2> ^predicate-structure <ps> ^type action ^verb-structure <vs>)
   (<dc> ^learn-link <pred2>)
}

sp {store-predicate-structure*elaborate*top-state*dialogue-context*multiplayer
   (state <s> ^name store-predicate-structure
              ^operator.name complete
              ^top-state <ts>)
   (<s> ^multiplayer <mult>)
   (<ts> ^dialog-context <dc>)
   (<dc> ^structure <pred>)
-->
   (<pred> ^multiplayer <mult>)
}



#sp {store-predicate-structure*elaborate*smem-retrieve
#   (state <s> ^name store-predicate-structure
#              ^predicate-lti <lti>)
#-->
#   (<s> ^smem-concept <lti>)
#}