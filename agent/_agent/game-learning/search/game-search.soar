sp {game-search*elaborate*problem-space
   (state <s> ^name game-search
              ^simulated true)
-->
   (<s> ^ntype action goal failure
        ^gtype action failure)
}
sp {game-search*elaborate*operator
   (state <s> ^name game-search
              ^superstate.operator <o>)
   (<o> ^name game-search
        ^dcount <dc>
        ^depth-limit <dl>
        ^list <l>
        ^current <g> 
        ^game <name>)
-->
   (<s> ^dcount <dc>
        ^depth-limit <dl>
        ^list <l>
        ^problemspace games
        ^desired <d>
        ^current <g> 
        ^game <name>)
   (<d> ^found true)
}

sp {game-search*elaborate*goal #for only at depth
   (state <s> ^name game-search
              ^simulated true
              ^dcount <dc>
              ^depth-limit <dc>)
-->
   (<s> ^gtype goal
        ^goal-search-delay 1)
}

sp {game-search*increment-goal-delay #for only at depth
   (state <s> ^name game-search
              ^goal-search-delay {<d> < 10})
-->
   (<s> ^goal-search-delay (+ 1 <d>))
}

sp {game-search*elaborate*multiplayer
   (state <s> ^name game-search
              ^superstate.superstate.multiplayer <m>)
-->
   (<s> ^multiplayer <m>)
}

sp {game-search*elaborate*game
   (state <s> ^name game-search
              ^superstate.superstate.game <m>)
-->
   (<s> ^game <m>)
}
              
sp {game-search*elaborate*depth-limit
   (state <s> ^name game-search
              ^superstate.superstate.depth-limit <m>)
-->
   (<s> ^depth-limit <m>)
}
sp {game-search*elaborate*list
   (state <s> ^name game-search
              ^superstate.superstate.list <m>)
-->
   (<s> ^list <m>)
}
sp {game-search*elaborate*dcount
   (state <s> ^name game-search
              ^superstate.superstate.dcount <dc>)
-->
   (<s> ^dcount (+ 1 <dc>))
}

sp {game-search*elaborate*problem-space*world
   (state <s> ^name game-search
              ^superstate.superstate.world <world2>)
-->
   (<s> ^problem-space <ps>)
   (<ps> ^world <world> ^name action ^dont-copy-anything true)
   (<world> ^source <world2>
            ^copy-type deep)
}


#need to make sure objects same?
sp {game-search*apply*simulate
   (state <s> ^name game-search
  #            ^action <act>
              ^copy-objects-map <com>
              ^world.predicates <p2>
              ^operator <o>)
 #  (<act> ^handle <cname>)
   (<o> ^type action
        ^name <cname>
        ^verb-structure.<num> <v1>  #multiple actions possible
        ^parameters <p>)
   (<p2> ^predicate <prep> ^predicate <prep2>)
   (<prep> ^handle below1 ^instance <instance>)
   (<instance> ^2 <obja>)
   (<prep2> ^handle on1 ^instance <instance2>)
   (<instance2> ^1 <obja>)
   (<p> ^<i1> <obj> ^<i2> <obj1>)
   (<obj> ^handle <ha>)
   (<com> ^<obj> <obja> ^<obj1> <objb>)
   (<v1> ^verb-prep on1 ^1 <i1> ^2 <i2>)
   
-->
   (<prep> ^instance <instance> -
           ^instance <instance3>)
   (<prep2> ^instance <instance2> -
            ^instance <instance4>)
   (<instance3> ^1 <objb> ^2 <obja>)
   (<instance4> ^1 <obja> ^2 <objb>)
}

#move set of objects
sp {game-search*apply*simulate*set
   (state <s> ^name game-search
              #^action <act>
              ^copy-objects-map <com>
              ^world.predicates <p2>
              ^operator <o>)
   #(<act> ^handle <cname>)
   (<o> ^type action
        ^name <cname>
        ^verb-structure.<num> <v1>  #multiple actions possible
        ^parameters <p>)
   (<p2> ^predicate <prep> ^predicate <prep2>)
   (<prep> ^handle below1 ^instance <instance>)
   (<instance> ^2 <obja>)
   (<prep2> ^handle on1 ^instance <instance2>)
   (<instance2> ^1 <obja>)
   (<p> ^<i1> <objects> ^<i2> <obj1>)
   (<objects> ^object <obj>)
   (<obj> ^handle <ha>)
   (<com> ^<obj> <obja> ^<obj1> <objb>)
   (<v1> ^verb-prep on1 ^1 <i1> ^2 <i2>)
   
-->
   (<prep> ^instance <instance> -
           ^instance <instance3>)
   (<prep2> ^instance <instance2> -
            ^instance <instance4>)
   (<instance3> ^1 <objb> ^2 <obja>)
   (<instance4> ^1 <obja> ^2 <objb>)
}

sp {game-search*apply*simulate2
   (state <s> ^name game-search
              #^action <act>
              ^copy-objects-map <com>
              ^world.predicates <p2>
              ^operator <o>)
 #  (<act>  ^handle <cname>)
   (<o> ^type action
        ^name <cname>
        ^verb-structure.<num> <v1>
        ^parameters <p>)
   (<p2> ^predicate <prep> ^predicate <prep2>)
   (<prep> ^handle below1 -^instance.{2} <obja>)
   (<prep2> ^handle on1 -^instance.{1} <obja>)
   (<p> ^<i1> <obj> ^<i2> <obj1>)
   (<obj> ^handle <ha>)
   (<com> ^<obj> <obja> ^<obj1> <objb>)
   (<v1> ^verb-prep on1 ^1 <i1> ^2 <i2>)
   
-->
   (<prep> ^instance <instance3>)
   (<prep2> ^instance <instance4>)
   (<instance3> ^1 <objb> ^2 <obja>)
   (<instance4> ^1 <obja> ^2 <objb>)
}
sp {game-search*apply*simulate2*set
   (state <s> ^name game-search
             # ^action <act>
              ^copy-objects-map <com>
              ^world.predicates <p2>
              ^operator <o>)
 #  (<act>  ^handle <cname>)
   (<o> ^type action
        ^name <cname>
        ^verb-structure.<num> <v1>
        ^parameters <p>)
   (<p2> ^predicate <prep> ^predicate <prep2>)
   (<prep> ^handle below1 -^instance.{2} <obja>)
   (<prep2> ^handle on1 -^instance.{1} <obja>)
   (<p> ^<i1> <objects> ^<i2> <obj1>)
   (<objects> ^object <obj>)
   (<obj> ^handle <ha>)
   (<com> ^<obj> <obja> ^<obj1> <objb>)
   (<v1> ^verb-prep on1 ^1 <i1> ^2 <i2>)
   
-->
   (<prep> ^instance <instance3>)
   (<prep2> ^instance <instance4>)
   (<instance3> ^1 <objb> ^2 <obja>)
   (<instance4> ^1 <obja> ^2 <objb>)
}


#sp {game-search*apply*simulate2
#   (state <s> ^name game-search
#              ^action <act>
#              
#              ^prepositions <p2>
#              ^operator <o>)
#   (<act> ^handle <cname>)
#   (<o> ^type action
#        ^name <cname>
#        ^verb-structure <v1>
#        ^parameters <p>)
#   (<p2> ^prep <prep> ^prep <prep2>)
#   (<prep> ^name below -^instance.{2} <obj>)
#   (<prep2> ^name on -^instance.{1} <obj>)
#   (<p> ^<i1> <obj> ^<i2> <obj1>)
#   #(<v> ^1 <v1>)#for now only handle 1 verb actions
#   (<v1> ^verb-prep on1 ^1 <i1> ^2 <i2>)
#-->
#   (<prep> ^instance <instance3>)
#   (<prep2> ^instance <instance4>)
#   (<instance3> ^1 <obj1> ^2 <obj>)
#   (<instance4> ^1 <obj> ^2 <obj1>)
#}


sp {game-search*elaborate*top-level*simulated
#:interrupt
   (state <s> ^name game-search
              ^superstate.name find-solution)
-->
   (<s> ^simulated true)
}

sp {game-search*elaborate*other-levels*simulated
   (state <s> ^name game-search
              ^operator <o>)
   (<o> ^type action ^duplicate-of)
-->
   (<s> ^simulated true)
}

sp {game-search*elaborate*action*nlp-set
   (state <s> ^name game-search
              ^gtype <gtype>
              ^<gtype> <act>)
   (<act> ^predicate-structure <p>)
-->
	(<act> ^nlp-set <p>)
}

sp {game-search*elaborate*sub-conditions
   (state <s> ^name game-search
              ^gtype <type>
              ^<type> <t>)
   (<t> ^condition <co>)
   (<co> ^args.{<arg> << 1 2 3 4 5 6 7 8 9 10 >>} <cond>)
   (<cond> ^name <name>)
-->
   (<t> ^condition <cond>)
}
sp {game-search*elaborate*sub-conditions*predicate
   (state <s> ^name game-search
              ^gtype <type>
              ^<type> <t>)
   (<t> ^nlp-set.conditions <cond>)
-->
   (<t> ^condition <cond>)
}

sp {game-search*elaborate*nlp-set*verb-structure
   (state <s> ^name game-search
              ^gtype action
              ^action <t>)
   (<t> ^nlp-set.verb-structure <vs>)
-->
(<t> ^verb-structure <vs>)
}

sp {game-search*elaborate*opponent
   (state <s> ^name game-search
              ^multiplayer true
              ^dcount << 1 3 5 7 >>)
-->
   (<s> ^opponent true)
}

sp {game-search*elaborate*opponent*false
   (state <s> ^name game-search
              ^multiplayer true
              ^dcount << 0 2 4 6 >>)
-->
   (<s> ^opponent false)
}

sp {game-search*elaborate*retrieve-game
   (state <s> ^name game-search
              ^game <m>)
-->
   (<s> ^retrieve-game <m>)
}


sp {game-search*elaborate*input-args
   (state <s> ^name game-search
              ^gtype <gtype>
              ^predicate <T5>
              ^<gtype>.condition <co>)
   (<co> ^type concept ^attribute predicate ^name <name> ^args <args>)
   (<args> ^num > 0)
   (<args> ^<a1> <c1>)
   (<c1> ^result.set.instance <in1> ^rtype <rtype>)
   (<T5> ^link <co> ^condition <c> ^nlp-set <nlps> ^parameter-set <P124> ^potential-args <P125>)
   (<c> ^attribute input-arg ^parameter.{1}.param-id <a1> ^rtype <rtype>)
   (<nlps> ^aname <name>)
   (<c> ^result.set <res2>)
-->
   (<res2> ^instance <in1>)
}


sp {game-search*elaborate*input-args*set-to-single*objects
   (state <s> ^name game-search
              ^gtype <gtype>
              ^predicate <T5>
              ^<gtype>.condition <co>)
   (<co> ^type concept ^attribute predicate ^name <name> ^args <args>)
   (<args> ^num > 0)
   (<args> ^<a1> <c1>)
   (<c1> ^result.set.instance.{1}.<elem> <obj> ^rtype set)# ^parameter.num 0)
   (<T5> ^link <co> ^condition <c> ^nlp-set <nlps> ^parameter-set <P124> ^potential-args <P125>)
   (<c> ^result.set <res> ^attribute input-arg ^parameter.{1}.param-id <a1> ^rtype single)
   (<nlps> ^aname <name>)
-->
   (<res> ^instance <i15>)
   (<i15> ^1 <obj>)
}


sp {game-search*apply*action*perform-action
   (state <s> ^name selection
              ^evaluation <e>
              ^superstate.dcount <dc>
              ^top-state <ts>
              ^problemspace games)
   (<e> ^symbolic-value success ^superoperator <so>)
   (<so> ^parameters <p> ^verb-structure <vs>)
   (<vs> ^<num> <vs2>)
   (<p> ^<i1> <o1> ^<i2> <o2>)
  # (<v> ^1 <v1>)#for now only handle 1 verb actions
   (<vs2> ^verb-prep <vp> ^verb-name <vname> ^1 <i1> ^2 <i2>)
-->
   (<ts> ^perform-action <fa>)
   (<fa> ^dcount (- (+ (* 2 <dc>) <num>) 1) ^obj1 <o1> ^obj2 <o2> ^pname <vp> ^vname <vname>)
}

sp {game-search*apply*action-success
   (state <s> ^name game-search
              ^desired <d>
              ^operator <o>)
   (<o> ^name action -^duplicate-of)
-->
   (<s> ^success <d>)
}


sp {game-search*apply*action*perform-action*top
   (state <s> ^name game-search
              ^top-state <ts>
              ^superstate <sss>
              ^dcount 0
              ^action <act>
              ^operator <o>)
   (<o> ^type action -^duplicate-of ^parameters <p> ^name <cname>)
   (<act> ^verb-structure.<num> <v1> ^handle <cname>)
   (<p> ^<i1> <o1> ^<i2> <o2>)
   #(<v> ^1 <v1>)#for now only handle 1 verb actions
   (<v1> ^verb-prep <vp> ^verb-name <vname> ^1 <i1> ^2 <i2>)
-->
   (<sss> ^found-action true)
 #  (<a> ^verb <vname> ^pname <vp>)
#   (<ts> ^perform-action <fa>)
#   (<fa> ^dcount 0 ^obj1 <o1> ^obj2 <o2> ^mark done ^pname <vp>)
}

#???????????????? for multiplayer
sp {game-search*apply*action*perform-action*top*singleaction
   (state <s> ^name game-search
              ^top-state <ts>
              ^superstate <sss>
              ^multiplayer true
              ^dcount 0
              ^action <act>
              ^operator <o>)
   (<o> ^type action -^duplicate-of ^parameters <p> ^name <cname>)
   (<act> ^verb-structure.<num> <v1> ^handle <cname>)
   (<p> ^<i1> <o1> ^<i2> <o2>)
   #(<v> ^1 <v1>)#for now only handle 1 verb actions
   (<v1> ^verb-prep <vp> ^verb-name <vname> ^1 <i1> ^2 <i2>)
-->
   (<ts> ^perform-action <fa>)
   (<fa> ^dcount (- <num> 1) ^obj1 <o1> ^obj2 <o2> ^pname <vp> ^vname <vname>)
}

sp {game-search*apply*game-won
   (state <s> ^name game-search
              ^multiplayer true
              ^top-state.dialog-context <dc>
              ^desired <d>
              ^operator.type goal)
-->
   (<dc> ^game-won true)
}
sp {game-search*apply*goal
   (state <s> ^name game-search
              ^desired <d>
              ^operator.type goal)
-->
   (<s> ^success <d>)
}

sp {game-search*apply*game-lost
   (state <s> ^name game-search
              ^multiplayer true
              ^top-state.dialog-context <dc>
              ^desired <d>
              ^operator.type failure)
-->
   (<dc> ^game-lost true)
}

sp {game-search*apply*failure
   (state <s> ^name game-search
              ^desired <d>
              ^operator.type failure)
-->
   (<s> ^partial-failure <d>)
}


sp {game-search*depth-limit
   (state <s> ^name game-search
              ^desired <d>
              ^goal-search-delay 10
              ^operator <o> +
             -^goal.parameter-set.set
              ^simulated true
              ^dcount <dc>
              ^depth-limit <dc>)
   (<o> ^type action -^duplicate-of)
 -{(<s> ^operator <o2> +)
   (<o2> ^type goal)}
-->
   (<s> ^partial-failure <d>)
}
sp {game-search*prefer*goal
   (state <s> ^name game-search
              ^operator <o1> +)
   (<o1> ^type goal)
-->
   (<s> ^operator <o1> > =)
}
sp {game-search*prefer*failure
   (state <s> ^name game-search
              ^operator <o1> +)
   (<o1> ^type failure)
-->
   (<s> ^operator <o1> > =)
}

#todo reject if same action type or any action? NOT THIS ONE
#sp {game-search*heuristic*reject
#   (state <s> ^name game-search
#              ^superstate.operator.superoperator.parameters <p2>
#              ^action <act>
#          #    ^action <act2>
#              ^operator <o2>
#              ^operator <o> +)
#   (<act> ^handle <cname> ^verb-structure.{1} <ind>)
#   (<o> ^type action -^duplicate-of ^parameters <p> ^name <cname>)
#   (<p> ^<ind>.handle <h1>)
#   (<p2> ^<ind>.handle <h1>)
# #  (<act2> ^handle <cname2> ^verb-structure.{1} <ind>)
#   (<o2> ^type action -^duplicate-of ^parameters <p4> ^name <cname>)
#   (<p4> ^<ind>.handle {<h2> <> <h1>}) #as long as one action of that type still there
#-->
#   (<s> ^operator <o> -)
#}

#for cannibals
#sp {game-search*equivalent-action*reject
#   (state <s> ^name game-search
#              ^operator <o1> +
#              ^operator <o2> +)
#   (<o1> ^type action -^duplicate-of ^parameters <p> ^name <cname> ^verb-structure <vs>)
#   (<o2> ^type action -^duplicate-of ^parameters {<p2> > <p>} ^name <cname>)
#   (<vs> ^2 <act1> -^3)
#   (<act1> ^1 <in1> ^2 <in2>)
#   (<p> ^<in1> <a> ^<in2> <b>)
#   (<p2> ^<in1> <c> ^<in2> <b>)
#-{(<a> ^predicates.<x1> <x>)
# -{(<c> ^predicates.<x1> <x>)}}
#-{(<c> ^predicates.<y1> <y>)
# -{(<a> ^predicates.<y1> <y>)}}
## (<s> ^world.predicates <wp>)
##-{(<wp> ^predicate <prep>)
##  (<prep> ^instance <is>)
##  (<is> ^<i31> <a> ^{<i32> <> <i31>} <q2>)
## -{(<prep> ^instance <is2>)
##   (<is2> ^<i31> <c> ^<i32> <q2>)}}
##-{(<wp> ^predicate <prep2>)
##  (<prep2> ^instance <is3>)
##  (<is3> ^<i11> <c> ^{<i21> <> <i11>} <q>)
## -{(<prep2> ^instance <is4>)
##   (<is4> ^<i11> <a> ^<i21> <q>)}}
#-->
#   (<s> ^operator <o2> -)
#}

#sp {game-search*equivalent-action*partial-reject
#   (state <s> ^name game-search
#              ^operator <o1> +
#              ^operator <o2> +)
#   (<o1> ^type action -^duplicate-of ^parameters <p> ^name <cname> ^verb-structure <vs>)
#   (<o2> ^type action -^duplicate-of ^parameters {<p2> > <p>} ^name <cname>)
#   (<vs> ^<num> <act1> ^{<num2> <> <num>} <act3> ^2)
#   (<act1> ^1 <in1> ^2 <in2>)
#   (<act3> ^1 <in3> ^2 <in4>)
#   (<p> ^<in1> <a> ^<in2> <b>)
#   (<p2> ^<in3> <c> ^<in4> <b>)
#-{(<a> ^predicates.<x1> <x>)
# -{(<c> ^predicates.<x1> <x>)}}
#-{(<c> ^predicates.<y1> <y>)
# -{(<a> ^predicates.<y1> <y>)}}
# (<s> ^world.predicates <wp>)
#-{(<wp> ^predicate <prep>)
#  (<prep> ^instance <is>)
#  (<is> ^<i31> <a> ^{<i32> <> <i31>} <q2>)
# -{(<prep> ^instance <is2>)
#   (<is2> ^<i31> <c> ^<i32> <q2>)}}
#-{(<wp> ^predicate <prep2>)
#  (<prep2> ^instance <is3>)
#  (<is3> ^<i11> <c> ^{<i21> <> <i11>} <q>)
# -{(<prep2> ^instance <is4>)
#   (<is4> ^<i11> <a> ^<i21> <q>)}}
#-->
#   (<o2> ^reject-pair <rp>)
#   (<rp> ^<p> <num2>)
#}
#sp {game-search*equivalent-action*reject4*allrejected
#   (state <s> ^name game-search
#              ^operator <o2> +)
#   (<o2> ^type action -^duplicate-of ^parameters <p> ^name <cname> ^verb-structure <vs> ^reject-pair <rp>)
#   (<vs> ^3 -^4)
#   (<rp> ^<predicate> 1 2 3)
#-->
#   (<s> ^operator <o2> -)
#}

sp {game-search*equivalent-action*reject4*ordering
   (state <s> ^name game-search
              ^operator <o1> +
              ^operator <o2> +)
   (<o1> ^type action -^duplicate-of ^parameters <p> ^name <cname> ^verb-structure <vs>)
   (<o2> ^type action -^duplicate-of ^parameters {<p2> > <p>} ^name <cname>)
   (<vs> ^1 <act1> ^3 <act3>)
   (<act1> ^1 <in1> ^2 <in2>)
   (<act3> ^1 <in3> ^2 <in4>)
   (<p> ^<in1> <a> ^<in2> <b> ^<in3> <a1> ^<in4> <b1> )
   (<p2> ^<in3> <a> ^<in4> <b> ^<in1> <a1> ^<in2> <b1> )
-->
(<s> ^operator <o2> -)
}

#cannibals
##TODO make more general rule, that test all verb orderings
#sp {game-search*equivalent-action*reject3
#   (state <s> ^name game-search
#              #^dcount 0
#              ^operator <o1> +
#              ^operator <o2> +)
#   (<o1> ^type action -^duplicate-of ^parameters <p> ^name <cname> ^verb-structure <vs>)
#   (<o2> ^type action -^duplicate-of ^parameters {<p2> > <p>} ^name <cname>)
#   (<vs> ^1 <act1> ^3 <act3>)
#   (<act1> ^1 <in1> ^2 <in2>)
#   (<act3> ^1 <in3> ^2 <in4>)
#   (<p> ^<in1> <a> ^<in2> <b> ^<in3> <a1> ^<in4> <b1> )
#   (<p2> ^<in1> {<c> <> <a>} ^<in2> <b> ^<in3> {<c1> <> <a1>} ^<in4> <b1> )
#-{(<a> ^predicates.<x1> <x>)
# -{(<c> ^predicates.<x1> <x>)}}
#-{(<c> ^predicates.<y1> <y>)
# -{(<a> ^predicates.<y1> <y>)}}
#-{(<a1> ^predicates.<x1> <x>)
# -{(<c1> ^predicates.<x1> <x>)}}
#-{(<c1> ^predicates.<y1> <y>)
# -{(<a1> ^predicates.<y1> <y>)}}
# (<s> ^world.predicates <wp>)
##-{(<wp> ^predicate <prep>)
##  (<prep> ^instance <is>)
##  (<is> ^<i31> <a> ^{<i32> <> <i31>} <q2>)
## -{(<prep> ^instance <is2>)
##   (<is2> ^<i31> <c> ^<i32> <q2>)}}
##-{(<wp> ^predicate <prep2>)
##  (<prep2> ^instance <is3>)
##  (<is3> ^<i11> <c> ^{<i21> <> <i11>} <q>)
## -{(<prep2> ^instance <is4>)
##   (<is4> ^<i11> <a> ^<i21> <q>)}}
##-{(<wp> ^predicate <prep>)
##  (<prep> ^instance <is>)
##  (<is> ^<i31> <a1> ^{<i32> <> <i31>} <q2>)
## -{(<prep> ^instance <is2>)
##   (<is2> ^<i31> <c1> ^<i32> <q2>)}}
##-{(<wp> ^predicate <prep2>)
##  (<prep2> ^instance <is3>)
##  (<is3> ^<i11> <c1> ^{<i21> <> <i11>} <q>)
## -{(<prep2> ^instance <is4>)
##   (<is4> ^<i11> <a1> ^<i21> <q>)}}
#-->
#   (<s> ^operator <o2> -)
#}
#cannibals
#sp {game-search*equivalent-action*reject3asame
#   (state <s> ^name game-search
#              ^dcount < 8
#              ^operator <o1> +
#              ^operator <o2> +)
#   (<o1> ^type action -^duplicate-of ^parameters <p> ^name <cname> ^verb-structure <vs>)
#   (<o2> ^type action -^duplicate-of ^parameters {<p2> > <p>} ^name <cname>)
#   (<vs> ^1 <act1> ^3 <act3>)
#   (<act1> ^1 <in1> ^2 <in2>)
#   (<act3> ^1 <in3> ^2 <in4>)
#   (<p> ^<in1> <a> ^<in2> <b> ^<in3> <a1> ^<in4> <b1> )
#   (<p2> ^<in1> <a> ^<in2> <b> ^<in3> {<c1> <> <a1>} ^<in4> <b1> )
#-{(<a1> ^predicates.<x1> <x>)
# -{(<c1> ^predicates.<x1> <x>)}}
#-{(<c1> ^predicates.<y1> <y>)
# -{(<a1> ^predicates.<y1> <y>)}}
## (<s> ^world.predicates <wp>)
##-{(<wp> ^predicate <prep>)
##  (<prep> ^instance <is>)
##  (<is> ^<i31> <a1> ^{<i32> <> <i31>} <q2>)
## -{(<prep> ^instance <is2>)
##   (<is2> ^<i31> <c1> ^<i32> <q2>)}}
##-{(<wp> ^predicate <prep2>)
##  (<prep2> ^instance <is3>)
##  (<is3> ^<i11> <c1> ^{<i21> <> <i11>} <q>)
## -{(<prep2> ^instance <is4>)
##   (<is4> ^<i11> <a1> ^<i21> <q>)}}
#-->
#   (<s> ^operator <o2> -)
#}
#cannibals
#sp {game-search*equivalent-action*reject3a1same
#   (state <s> ^name game-search
#            #  ^dcount 0 2 4
#              ^dcount < 8
#              ^operator <o1> +
#              ^operator <o2> +)
#   (<o1> ^type action -^duplicate-of ^parameters <p> ^name <cname> ^verb-structure <vs>)
#   (<o2> ^type action -^duplicate-of ^parameters {<p2> > <p>} ^name <cname>)
#   (<vs> ^1 <act1> ^3 <act3>)
#   (<act1> ^1 <in1> ^2 <in2>)
#   (<act3> ^1 <in3> ^2 <in4>)
#   (<p> ^<in3> <a> ^<in4> <b> ^<in1> <a1> ^<in2> <b1> )
#   (<p2> ^<in3> <a> ^<in4> <b> ^<in1> {<c1> <> <a1>} ^<in2> <b1> )
#-{(<a1> ^predicates.<x1> <x>)
# -{(<c1> ^predicates.<x1> <x>)}}
#-{(<c1> ^predicates.<y1> <y>)
# -{(<a1> ^predicates.<y1> <y>)}}
## (<s> ^world.predicates <wp>)
##-{(<wp> ^predicate <prep>)
##  (<prep> ^instance <is>)
##  (<is> ^<i31> <a1> ^{<i32> <> <i31>} <q2>)
## -{(<prep> ^instance <is2>)
##   (<is2> ^<i31> <c1> ^<i32> <q2>)}}
##-{(<wp> ^predicate <prep2>)
##  (<prep2> ^instance <is3>)
##  (<is3> ^<i11> <c1> ^{<i21> <> <i11>} <q>)
## -{(<prep2> ^instance <is4>)
##   (<is4> ^<i11> <a1> ^<i21> <q>)}}
#-->
#   (<s> ^operator <o2> -)
#}


#uhhh
#sp {game-search*equivalent-action*reject3b
#   (state <s> ^name game-search
#              ^operator <o1> +
#              ^operator <o2> +)
#   (<o1> ^type action -^duplicate-of ^parameters <p> ^name <cname> ^verb-structure <vs>)
#   (<o2> ^type action -^duplicate-of ^parameters <p2> ^name <cname>)
#   (<vs> ^1 <act1> ^3 <act3>)
#   (<act1> ^1 <in1> ^2 <in2>)
#   (<act3> ^1 <in3> ^2 <in4>)
#   (<p> ^<in1> <a> ^<in2> <b> ^<in3> <a1> ^<in4> <b1> )
#   (<p2> ^<in3> <c> ^<in4> <b> ^<in1> <c1> ^<in2> <b1> )
#   #(<a> ^handle <h>)
#   #(<c> ^handle {<h1> < <h>})
#-{(<a> ^predicates.<x1> <x>)
# -{(<c> ^predicates.<x1> <x>)}}
#-{(<c> ^predicates.<y1> <y>)
# -{(<a> ^predicates.<y1> <y>)}}
#-{(<a1> ^predicates.<x1> <x>)
# -{(<c1> ^predicates.<x1> <x>)}}
#-{(<c1> ^predicates.<y1> <y>)
# -{(<a1> ^predicates.<y1> <y>)}}
# (<s> ^world.predicates <wp>)
#-{(<wp> ^predicate <prep>)
#  (<prep> ^instance <is>)
#  (<is> ^<i31> <a> ^{<i32> <> <i31>} <q2>)
# -{(<prep> ^instance <is2>)
#   (<is2> ^<i31> <c> ^<i32> <q2>)}}
#-{(<wp> ^predicate <prep2>)
#  (<prep2> ^instance <is3>)
#  (<is3> ^<i11> <c> ^{<i21> <> <i11>} <q>)
# -{(<prep2> ^instance <is4>)
#   (<is4> ^<i11> <a> ^<i21> <q>)}}
#-{(<wp> ^predicate <prep>)
#  (<prep> ^instance <is>)
#  (<is> ^<i31> <a1> ^{<i32> <> <i31>} <q2>)
# -{(<prep> ^instance <is2>)
#   (<is2> ^<i31> <c1> ^<i32> <q2>)}}
#-{(<wp> ^predicate <prep2>)
#  (<prep2> ^instance <is3>)
#  (<is3> ^<i11> <c1> ^{<i21> <> <i11>} <q>)
# -{(<prep2> ^instance <is4>)
#   (<is4> ^<i11> <a1> ^<i21> <q>)}}
#-->
#   (<s> ^operator <o2> -)
#}

#
sp {game-search*heuristic*reject
   (state <s> ^name game-search
              ^superstate.operator.superoperator <so>
              ^action <act>
          #    ^action <act2>
          #    ^operator <o2>
              ^operator <o> +)
   (<act> ^handle <cname> ^verb-structure.{1}.{1} <ind>)
   (<so> ^parameters <p2> ^verb-structure.{1}.{1} <ind2>)
   (<o> ^type action -^duplicate-of ^parameters <p> ^name <cname>)
   (<p> ^<ind>.handle <h1>)
   (<p2> ^<ind2>.handle <h1>)
 #  (<act2> ^handle <cname2> ^verb-structure.{1} <ind>)
  # (<o2> ^type action -^duplicate-of ^parameters <p4> ^name <cname>)
   #(<p4> ^<ind>.handle {<h2> <> <h1>}) #as long as one action of that type still there
-->
   (<s> ^operator <o> -)
}


sp {game-search*propose*default
   (state <s> ^name game-search)
   -{(<s> ^action <a>)
     (<a> -^parameter-set.argnum)}
-->
   (<s> ^operator <o1> +)
   (<o1> ^name default)
}

sp {game-search*apply*default
   (state <s> ^name game-search
              ^desired <d>
             -^dcount 0
              ^operator.name default)
-->
   (<s> ^partial-failure <d>)
}


#multiplayer, take random of best actions
sp {game-search*apply*default*top-select-random-action
   (state <s> ^name game-search
              ^operator <o> +
              ^multiplayer true
              ^dcount 0
              ^operator.name default)
   (<o> ^type action)
-->
   (<s> ^operator <o> > =)
}


#puzzle, increase depth
sp {game-search*apply*default*depth-limit-increase
   (state <s> ^name game-search
              ^multiplayer false
              ^dcount 0
              ^superstate <ss>
              ^operator.name default)
   (<ss> ^depth-limit <d>)
-->
#    (interrupt)
   (<ss> ^depth-limit <d> -)
   (<ss> ^depth-limit (+ <d> 1))
}

sp {selection*prefer*evaluate*action*over*default
   (state <s> ^name selection
              ^operator <o1> +
              ^operator <o2> +)
   (<o1> ^name evaluate-operator ^superoperator.type action)
   (<o2> ^name evaluate-operator ^superoperator.name default)
-->
   (<s> ^operator <o1> > <o2>)
}


sp {selection*prefer*evaluate*action*over*hackforcannibals
#:interrupt
   (state <s> ^name selection
              ^superstate.dcount 0
              ^operator <o1> +
              ^operator <o2> +)
   (<o1> ^name evaluate-operator ^superoperator <so>)
   (<o2> ^name evaluate-operator ^superoperator <so2>)
   (<so> ^type action -^verb-structure.{3})
   (<so2> ^type action ^verb-structure.{3})
-->
   (<s> ^operator <o1> > <o2>)
}