####################################################
# object arguments

# Propose copy-argument for each object argument

# Not using a map, just directly copy the object reference
sp {copy-action*propose*copy-argument*object*shallow*no*object-map
   (state <s> ^name copy-action
              ^copy-argument <ca>
              ^no-object-map true)
   (<ca> ^arg-type object
         ^source-arg.id <obj>)
        -^arg-copy)
-->
   (<s> ^operator <o> + =)
   (<o> ^name copy-argument
        ^argument <ca>
        ^arg-type object
        ^copy-type shallow
        ^object <obj>)
}

# We are using a map which has the object, use the map copy of the object
sp {copy-action*propose*copy-argument*object*shallow*using*object-map
   (state <s> ^name copy-action
              ^copy-argument <ca>
              ^object-map.entry <e>)
   (<ca> ^arg-type object
         ^source-arg.id <src-obj>)
        -^arg-copy)
   (<e> ^source <src-obj>
        ^copy <obj-copy>)
-->
   (<s> ^operator <o> + =)
   (<o> ^name copy-argument
        ^argument <ca>
        ^arg-type object
        ^copy-type shallow
        ^object <obj-copy>)
}

# The object is not in the object-map, deep copy it
sp {copy-action*propose*copy-argument*object*deep
   (state <s> ^name copy-action
              ^copy-argument <ca>
              ^object-map <map>)
   (<ca> ^arg-type object
         ^source-arg.id <src-obj>)
        -^arg-copy)
   (<map> -^entry.source <src-obj>)
-->
   (<s> ^operator <o> + =)
   (<o> ^name copy-argument
        ^argument <ca>
        ^arg-type object
        ^copy-type deep
        ^object <src-obj>)
}


### Apply the copy-argument by creating an object argument
sp {copy-action*apply*copy-argument*object*shallow*copy
   (state <s> ^name copy-action
              ^operator <o>)
   (<o> ^name copy-argument
        ^argument <arg>
        ^arg-type object
        ^copy-type shallow
        ^object <obj>)
-->
   (<arg> ^arg-copy <copy>)
   (<copy> ^arg-type object
           ^id <obj>)
}

# ENUMERATE: deep copy objects with 0-8 predicates

sp {copy-action*apply*copy-argument*object*deep*copy*0*predicates
   (state <s> ^name copy-action
              ^operator <o>)
   (<o> ^name copy-argument
        ^argument <arg>
        ^arg-type object
        ^copy-type deep
        ^object <obj>)
   (<obj> ^handle <h>
          ^predicates <preds>)
   (<preds> -^<p1> <v1>)

-->
   (<arg> ^arg-copy <copy>)
   (<copy> ^arg-type object
           ^id <new-obj>)
   (<new-obj> ^item-type object
              ^handle <h>
              ^predicates <new-preds>)
}

sp {copy-action*apply*copy-argument*object*deep*copy*1*predicates
   (state <s> ^name copy-action
              ^operator <o>)
   (<o> ^name copy-argument
        ^argument <arg>
        ^arg-type object
        ^copy-type deep
        ^object <obj>)
   (<obj> ^handle <h>
          ^predicates <preds>)
   (<preds> ^{ <p1>        } <v1>
           -^{ <p2> <> <p1> } <v2>)
-->
   (<arg> ^arg-copy <copy>)
   (<copy> ^arg-type object
           ^id <new-obj>)
   (<new-obj> ^item-type object
              ^handle <h>
              ^predicates <new-preds>)
   (<new-preds> ^<p1> <v1>)
}


sp {copy-action*apply*copy-argument*object*deep*copy*2*predicates
   (state <s> ^name copy-action
              ^operator <o>)
   (<o> ^name copy-argument
        ^argument <arg>
        ^arg-type object
        ^copy-type deep
        ^object <obj>)
   (<obj> ^handle <h>
          ^predicates <preds>)
   (<preds> ^{ <p1>        } <v1>
            ^{ <p2> > <p1> } <v2>
           -^{ <p3> <> <p2> <> <p1> } <v3>)
-->
   (<arg> ^arg-copy <copy>)
   (<copy> ^arg-type object
           ^id <new-obj>)
   (<new-obj> ^item-type object
              ^handle <h>
              ^predicates <new-preds>)
   (<new-preds> ^<p1> <v1>
                ^<p2> <v2>)
}

sp {copy-action*apply*copy-argument*object*deep*copy*3*predicates
   (state <s> ^name copy-action
              ^operator <o>)
   (<o> ^name copy-argument
        ^argument <arg>
        ^arg-type object
        ^copy-type deep
        ^object <obj>)
   (<obj> ^handle <h>
          ^predicates <preds>)
   (<preds> ^{ <p1>        } <v1>
            ^{ <p2> > <p1> } <v2>
            ^{ <p3> > <p2> } <v3>
           -^{ <p4> <> <p3> <> <p2> <> <p1> } <v4>)
-->
   (<arg> ^arg-copy <copy>)
   (<copy> ^arg-type object
           ^id <new-obj>)
   (<new-obj> ^item-type object
              ^handle <h>
              ^predicates <new-preds>)
   (<new-preds> ^<p1> <v1>
                ^<p2> <v2>
                ^<p3> <v3>)
}

sp {copy-action*apply*copy-argument*object*deep*copy*4*predicates
   (state <s> ^name copy-action
              ^operator <o>)
   (<o> ^name copy-argument
        ^argument <arg>
        ^arg-type object
        ^copy-type deep
        ^object <obj>)
   (<obj> ^handle <h>
          ^predicates <preds>)
   (<preds> ^{ <p1>        } <v1>
            ^{ <p2> > <p1> } <v2>
            ^{ <p3> > <p2> } <v3>
            ^{ <p4> > <p3> } <v4>
           -^{ <p5> <> <p4> <> <p3> <> <p2> <> <p1> } <v5>)
-->
   (<arg> ^arg-copy <copy>)
   (<copy> ^arg-type object
           ^id <new-obj>)
   (<new-obj> ^item-type object
              ^handle <h>
              ^predicates <new-preds>)
   (<new-preds> ^<p1> <v1>
                ^<p2> <v2>
                ^<p3> <v3>
                ^<p4> <v4>)
}

sp {copy-action*apply*copy-argument*object*deep*copy*5*predicates
   (state <s> ^name copy-action
              ^operator <o>)
   (<o> ^name copy-argument
        ^argument <arg>
        ^arg-type object
        ^copy-type deep
        ^object <obj>)
   (<obj> ^handle <h>
          ^predicates <preds>)
   (<preds> ^{ <p1>        } <v1>
            ^{ <p2> > <p1> } <v2>
            ^{ <p3> > <p2> } <v3>
            ^{ <p4> > <p3> } <v4>
            ^{ <p5> > <p4> } <v5>
           -^{ <p6> <> <p5> <> <p4> <> <p3> <> <p2> <> <p1> } <v6>)
-->
   (<arg> ^arg-copy <copy>)
   (<copy> ^arg-type object
           ^id <new-obj>)
   (<new-obj> ^item-type object
              ^handle <h>
              ^predicates <new-preds>)
   (<new-preds> ^<p1> <v1>
                ^<p2> <v2>
                ^<p3> <v3>
                ^<p4> <v4>
                ^<p5> <v5>)
}
     
sp {copy-action*apply*copy-argument*object*deep*copy*6*predicates
   (state <s> ^name copy-action
              ^operator <o>)
   (<o> ^name copy-argument
        ^argument <arg>
        ^arg-type object
        ^copy-type deep
        ^object <obj>)
   (<obj> ^handle <h>
          ^predicates <preds>)
   (<preds> ^{ <p1>        } <v1>
            ^{ <p2> > <p1> } <v2>
            ^{ <p3> > <p2> } <v3>
            ^{ <p4> > <p3> } <v4>
            ^{ <p5> > <p4> } <v5>
            ^{ <p6> > <p5> } <v6>
           -^{ <p7> <> <p6> <> <p5> <> <p4> <> <p3> <> <p2> <> <p1> } <v7>)
-->
   (<arg> ^arg-copy <copy>)
   (<copy> ^arg-type object
           ^id <new-obj>)
   (<new-obj> ^item-type object
              ^handle <h>
              ^predicates <new-preds>)
   (<new-preds> ^<p1> <v1>
                ^<p2> <v2>
                ^<p3> <v3>
                ^<p4> <v4>
                ^<p5> <v5>
                ^<p6> <v6>)
}
           
sp {copy-action*apply*copy-argument*object*deep*copy*7*predicates
   (state <s> ^name copy-action
              ^operator <o>)
   (<o> ^name copy-argument
        ^argument <arg>
        ^arg-type object
        ^copy-type deep
        ^object <obj>)
   (<obj> ^handle <h>
          ^predicates <preds>)
   (<preds> ^{ <p1>        } <v1>
            ^{ <p2> > <p1> } <v2>
            ^{ <p3> > <p2> } <v3>
            ^{ <p4> > <p3> } <v4>
            ^{ <p5> > <p4> } <v5>
            ^{ <p6> > <p5> } <v6>
            ^{ <p7> > <p6> } <v7>
           -^{ <p8> <> <p7> <> <p6> <> <p5> <> <p4> <> <p3> <> <p2> <> <p1> } <v8>)
-->
   (<arg> ^arg-copy <copy>)
   (<copy> ^arg-type object
           ^id <new-obj>)
   (<new-obj> ^item-type object
              ^handle <h>
              ^predicates <new-preds>)
   (<new-preds> ^<p1> <v1>
                ^<p2> <v2>
                ^<p3> <v3>
                ^<p4> <v4>
                ^<p5> <v5>
                ^<p6> <v6>
                ^<p7> <v7>)
}
        
sp {copy-action*apply*copy-argument*object*deep*copy*8*predicates
   (state <s> ^name copy-action
              ^operator <o>)
   (<o> ^name copy-argument
        ^argument <arg>
        ^arg-type object
        ^copy-type deep
        ^object <obj>)
   (<obj> ^handle <h>
          ^predicates <preds>)
   (<preds> ^{ <p1>        } <v1>
            ^{ <p2> > <p1> } <v2>
            ^{ <p3> > <p2> } <v3>
            ^{ <p4> > <p3> } <v4>
            ^{ <p5> > <p4> } <v5>
            ^{ <p6> > <p5> } <v6>
            ^{ <p7> > <p6> } <v7>
            ^{ <p8> > <p7> } <v8>
           -^{ <p9> <> <p8> <> <p7> <> <p6> <> <p5> <> <p4> <> <p3> <> <p2> <> <p1> } <v9>)
-->
   (<arg> ^arg-copy <copy>)
   (<copy> ^arg-type object
           ^id <new-obj>)
   (<new-obj> ^item-type object
              ^handle <h>
              ^predicates <new-preds>)
   (<new-preds> ^<p1> <v1>
                ^<p2> <v2>
                ^<p3> <v3>
                ^<p4> <v4>
                ^<p5> <v5>
                ^<p6> <v6>
                ^<p7> <v7>
                ^<p8> <v8>)
}
        