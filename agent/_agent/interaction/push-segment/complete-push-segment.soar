sp {push-segment*propose*complete-push-segment
   (state <s> ^name push-segment)
-->
   (<s> ^operator <o> + <)
   (<o> ^name complete-push-segment)
}

# Remove the new-segment-info from the status link (retracts operator)
sp {push-segment*apply*complete-push-segment*remove*new-segment-info
   (state <s> ^name push-segment
              ^operator.name complete-push-segment
              ^new-segment-info <info>
              ^topstate.interaction.status <status>)
   (<status> ^new-segment-info <info>)
-->
   (<status> ^new-segment-info <info> -)
}

# Pushes the actual segment onto the stack
sp {push-segment*apply*complete-push-segment*push-segment
   (state <s> ^name push-segment
              ^operator.name complete-push-segment
              ^segment <seg>
              ^epmem.present-id <epmem-id>
              ^topstate.interaction.stack <stack>)
   (<stack> ^segment <prev-seg>)
-->
   (<stack> ^segment <prev-seg> -
            ^segment <seg>)
   (<seg> ^epmem-id <epmem-id>)
   (<prev-seg> ^prev <seg>)
}

sp {push-segment*apply*complete-push-segment*send*message
   (state <s> ^name push-segment
              ^operator.name complete-push-segment
              ^new-segment-info.message <msg>
              ^io.output-link <out>)
-->
   (<out> ^send-message <msg>)
}