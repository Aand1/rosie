#TODO
#temp quick version for games, predicates

sp {interpret-message*propose*interpret-unknown-word
   (state <s> ^name interpret-message
          #   -^top-state.dialog-context.learning-predicate.name <word>
              ^instructor-message <msg>)
   (<msg> ^interaction-status.failure <f> 
         -^interpreted true)
   (<f> ^type unknown-word ^word <word>)
-->
   (<s> ^operator <o> + > =)
   (<o> ^name interpret-unknown-word
        ^word <word>
        ^message <msg>)
}

#TODO hack prefer clear before adjacent
sp {interpret-message*prefer*interpret-unknown-word*clear
   (state <s> ^name interpret-message
              ^operator <o2> +
                ^operator <o> +)
   (<o> ^name interpret-unknown-word
        ^word clear)
   (<o2> ^name interpret-unknown-word
        -^word clear)
-->
    (<s> ^operator <o> > <o2>)
}

######
# OPERATOR ELABORATIONS
######

#####
# OPERATOR APPLICATION
#####

# Mark the message as interpreted (retracts operator)
#   And send message to human
sp {interpret-message*apply*interpret-unknown-word*create*segment
   (state <s> ^name interpret-message
              ^top-state.dialog-context <dc>
              ^operator <o>)
   (<o> ^name interpret-unknown-word
        ^word <word>
        ^message <msg>)
-->
   (<dc> ^learning-predicate <lp>)
   (<lp> ^name <word>)
   (<s> ^mark-interpreted <msg>)
   (<s> ^outgoing-message <out-msg>)
   (<out-msg> ^type unknown-word
              ^fields.word <word>)
}


#sp {interpret-message*apply*interpret-unknown-word*copy-old-learn-link
#   (state <s> ^name interpret-message
#              ^top-state.dialog-context <dc>
#              ^operator <o>)
#   (<o> ^name interpret-unknown-word
#        ^word <word>
#        ^message <msg>)
#   (<dc> ^learn-link <ll>)
#   (<ll> ^type << action goal >>)
#-->
#    (<dc> ^store-learn-link <ll>)
#    (<dc> ^learn-link <ll> -)
#}

sp {interpret-message*apply*interpret-ignore*store-smem-word
   (state <s> ^name interpret-message
              ^smem.command <sc>
              ^top-state.dialog-context <dc>
              ^operator <o>)
   (<o> ^name interpret-unknown-word
        ^word <word>
        ^message <msg>)
-->
   # (<dc> ^stored <word>)
   # (<dc> ^learn-link <w>)
    (<sc> ^store <w1> <spell> <p3>)
    (<w1> ^handle <word> ^property <p3>)
    (<spell> ^spelling <word> ^structure-type ADJ ^referent <w1>)
    (<p3> ^handle property ^type visual)
  #  (<p3>
#          (<cle1>  ^spelling |clear|
#                   ^structure-type ADJ
#                   ^referent @G1100)
#          (@G1100  ^handle clear
#                   ^property <cle3>)
#          (<cle3>  ^handle property
#                   ^type visual)
    
}
#smem --add {(<adja> ^spelling |adjacent|
#                    ^structure-type P
#                    ^relation @R1018
#                    ^converts-to PP)
#}
#smem --add {
#           (<next> ^prior-word |adjacent|
#                   ^current-word |to|
#                   ^spelling |adjacent-to|  ## Construction?
#                   ^structure-type P
#                   ^relation @R1018
#                   ^assigners <next-to1>
#                   ^converts-to PP)
#           (<next-to1> ^structure-type DP
#                    ^relative-position after
#                    ^syntactic-structure head
#                    ^required true)
#}
    

