sp {topstate*propose*init-agent
   (state <s> -^name
   	      ^superstate nil)
-->
   (<s> ^operator <op> + >)
   (<op> ^name init-agent)
}

sp {topstate*apply*init-agent
	(state <s> ^operator <op>)
    (<op> ^name init-agent)
-->
	(<s> ^topstate <s>
      	 ^name motion-control)
}

### Just for demoing
sp {topstate*propose*first-grab
	(state <s> ^name motion-control
           	  -^first-grab-requested
              -^request)
-->
	(<s> ^operator.name first-grab +=)
}

sp {topstate*apply*first-grab
	(state <s> ^name motion-control
               ^operator.name first-grab)
-->
	(<s> ^request <r>
      	 ^first-grab-requested true)
	(<r> ^target <t>
         ^type grasp
         ^step-size 0.6
         ^speed 0.9
         ^time-limit 3.0
         ^hard-time-limit false)
 	(<t> ^id 1)
}

sp {topstate*propose*first-drop
	(state <s> ^name motion-control
           	   ^first-grab-requested
              -^first-drop-requested
              -^request)
-->
	(<s> ^operator.name first-drop +=)
}

sp {topstate*apply*first-drop
	(state <s> ^name motion-control
               ^operator.name first-drop)
-->
	(<s> ^request <r>
      	 ^first-drop-requested true)
	(<r> ^target <t>
         ^type drop
         ^time-limit 3.0
         ^hard-time-limit false
         ^speed 0.9)
 	(<t> ^x 0.2
         ^y 0.2
         ^z 0)
}

##################
sp {topstate*propose*reset
	(state <s> ^name motion-control
               ^first-drop-requested
           	  -^reset-requested
              -^request
               ^io.output-link <ol>)
 	(<ol> -^reset)
-->
	(<s> ^operator.name reset +=)
}

sp {topstate*apply*reset
	(state <s> ^name motion-control
               ^operator.name reset
               ^io.output-link <ol>)
-->
	(<s> ^reset-requested true)
	(<ol> ^reset <r>)
    (<r> ^needs something)
}
#################
sp {topstate*propose*second-grab
	(state <s> ^name motion-control
               ^reset-requested
               ^io.output-link.reset <r>
           	  -^second-grab-requested
              -^request)
 	(<r> ^status finished)
-->
	(<s> ^operator.name second-grab +=)
 	(interrupt)
}

sp {topstate*apply*second-grab
	(state <s> ^name motion-control
               ^operator.name second-grab)
-->
	(<s> ^request <r>
      	 ^second-grab-requested true)
	(<r> ^target <t>
      	 ^type grasp
         ^time-limit 8.0
         ^hard-time-limit true
         ^step-size 0.2
         ^speed 0.5)
 	(<t> ^id 1)
}

sp {topstate*propose*second-drop
	(state <s> ^name motion-control
           	   ^second-grab-requested
              -^second-drop-requested
              -^request)
-->
	(<s> ^operator.name second-drop +=)
}

sp {topstate*apply*second-drop
	(state <s> ^name motion-control
               ^operator.name second-drop)
-->
	(<s> ^request <r>
      	 ^second-drop-requested true)
	(<r> ^target <t>
         ^type drop
         ^time-limit 8.0
         ^hard-time-limit true
         ^step-size 0.2
         ^speed 0.5)
 	(<t> ^x 0.2
         ^y 0.2
         ^z 0)
}

#sp {propose*pause-test
#	(state <s> ^name interpret-motion-request
#               ^topstate.io.output-link <ol>)
# 	(<ol> ^search <srch>)
#  	(<srch> ^status requested)
#    (<ol> -^pause <ps>)
#    (<s> -^pause demoed)
#-->
#	(<s> ^operator <op> + >)
# 	(<op> ^name pause-test)
#}
#
#sp {apply*pause-test
#	(state <s> ^name interpret-motion-request
#               ^operator.name pause-test
#               ^topstate.io.output-link <ol>)
# 	(<ol> ^search <srch>)
#  	(<srch> ^status requested)
#-->
#	(<ol> ^pause <p>)
# 	(<p> ^info null)
#  	(<s> ^pause demoed)
#}
#
sp {propose*continue-test
	(state <s> ^name interpret-motion-request
               ^topstate.io.output-link <ol>)
 	(<ol> ^plan <ps>)
  	(<ps> ^status paused)
-->
	(<s> ^operator <op> + >)
 	(<op> ^name continue-test)
}

sp {apply*continue-test
	(state <s> ^name interpret-motion-request
               ^operator.name continue-test
               ^topstate.io.output-link <ol>)
 	(<ol> ^plan <ps>)
-->
	(<ol> ^continue <p>)
 	(<p> ^info null)
}