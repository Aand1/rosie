
## While the arm is moving, don't do any attending except for new objects
## Don't attend to new objects while the arm is moving
sp {op_put-down1*reject*attend-to-scene-change*while*moving
   (state <s> ^name op_put-down1
              ^operator <o> +
              ^current-action.put-down-command <cmd>)
   (<o> ^name attend-to-scene-change
        ^change.type <> new-object)
   (<cmd> -^status)
-->
   (<s> ^operator <o> -)
}

## Once the arm is finished, if the held-object is missing,
## Then add new objects as candidates for the missing object
sp {op_put-down1*elaborate*evaluate-new-object*candidate-for-missing-object
   (state <s> ^name op_put-down1
              ^operator <o> +
              ^held-object <obj>
              ^top-state.perception-monitor.object-monitor.object-info <obj-info>)
   (<o> ^name attend-to-scene-change
        ^change.type new-stable-object
        ^change.object-info <cand>)
   (<obj> ^handle <obj-handle>
          ^predicates.visible false)
   (<obj-info> ^object-handle <obj-handle>)
-->
   (<cand> ^candidate-for-missing-object <obj-info>)
}

## If we have to attend to a stale object, mark it as missing so it won't be deleted
sp {op_put-down1*elaborate*attend-to*stale-object*mark*missing
   (state <s> ^name op_put-down1
              ^operator <o> +
              ^held-object <obj>)
   (<o> ^name attend-to-scene-change
        ^change.type stale-object
        ^change.object-info <obj-info>)
   (<obj-info> ^wm-obj <obj>)
-->
   (<obj-info> ^missing true)
}

## If there are still new objects to process, don't attend-to-stale-object
sp {op_put-down1*reject*attend-to-stale-object*still*new*objects
   (state <s> ^name op_put-down1
              ^operator <o> +
              ^no-new-objects false
              ^held-object <obj>)
   (<o> ^name attend-to-scene-change
        ^change.type stale-object
        ^change.object-info.wm-obj <obj>)
-->
   (<s> ^operator <o> -)
}

## If the stale-object substate determined we can't find the object,
##   reject the operator (terminate the substate)
sp {op_put-down1*reject*attend-to-stale-object*cant-find
   (state <s> ^name op_put-down1
              ^operator <o> +
              ^held-object <obj>)
   (<o> ^name attend-to-scene-change
        ^change.type stale-object
        ^change.object-info <obj-info>)
   (<obj-info> ^wm-obj <obj>
               ^cant-find true)
-->
   (<s> ^operator <o> -)
}


#
#sp {op_put-down1*elaborate*evaluate-new-object*candidate-for-missing-object
#   (state <s> ^name execute-put-down1
#              ^operator <o> +
#              ^held-object.handle <obj-handle>
#              ^top-state.perception-monitor.object-monitor.object-info <obj-info>)
#   (<o> ^name attend-to-scene-change
#        ^change.type new-stable-object
#        ^change.object-info <cand>)
#   (<obj-info> ^object-handle <obj-handle>)
#-->
#   (<cand> ^candidate-for-missing-object <obj-info>)
#}
#


## Don't attend to stale-object on the object being grabbed
#sp {op_put-down1*reject*attend-to-stale-object*held*object
#   (state <s> ^name execute-put-down1
#              ^operator <o> +
#              ^held-object.handle <handle>)
#   (<o> ^name attend-to-scene-change
#        ^change.type stale-object
#        ^change.object-info.object-handle <handle>)
#-->
#   (<s> ^operator <o> -)
#}
#
## Don't attend to new objects while the arm is moving
## (only evaluate those that were added during the put down as candidates for missing)
#sp {op_put-down1*reject*attend-to-new-object
#   (state <s> ^name execute-put-down1
#              ^current-action.put-down-command <cmd>
#              ^operator <o> +)
#   (<o> ^name attend-to-scene-change
#        ^change.type new-stable-object)
#   (<cmd> -^status)
#-->
#   (<s> ^operator <o> -)
#}
#
#sp {op_put-down1*reject*attend-to-scene-change*all*during*put-down
#   (state <s> ^name execute-put-down1
#              ^current-action.put-down-command <cmd>
#              ^operator <o> +)
#   (<o> ^name attend-to-scene-change
#        ^change.type { <any> <> new-object })
#   (<cmd> -^status)
#-->
#   (<s> ^operator <o> -)
#}
#
## Don't attend at all to the object being put down up while the arm is moving
#sp {op_put-down1*reject*attend-to-scene-change*grabbed*object
#   (state <s> ^name execute-put-down1
#              ^operator <o> +
#              ^held-object.handle <handle>
#              ^current-action.put-down-command <cmd>)
#   (<o> ^name attend-to-scene-change
#        ^change.object-info.object-handle <handle>)
#   (<cmd> -^status)
#-->
#   (<s> ^operator <o> -)
#}
#
#sp {op_put-down1*elaborate*evaluate-new-object*candidate-for-missing-object
#   (state <s> ^name execute-put-down1
#              ^operator <o> +
#              ^held-object.handle <obj-handle>
#              ^top-state.perception-monitor.object-monitor.object-info <obj-info>)
#   (<o> ^name attend-to-scene-change
#        ^change.type new-stable-object
#        ^change.object-info <cand>)
#   (<obj-info> ^object-handle <obj-handle>)
#-->
#   (<cand> ^candidate-for-missing-object <obj-info>)
#}
