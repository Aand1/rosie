#sp {go-to-waypoint*propose*go-to-next-waypoint
#   (state <s> ^name go-to-waypoint
#              ^current-waypoint.edge <edge>
#              ^desired.waypoint.handle <des-handle>)
#   (<edge> ^to <des-handle> ^end <next-wp>)
#-->
#   (<s> ^operator <o> + =)
#   (<o> ^name go-to-next-waypoint
#        ^next-waypoint <next-wp>)
#}

sp {go-to-waypoint*propose*go-to-next-waypoint
   (state <s> ^name go-to-waypoint
              ^current-waypoint.next <next-wp>)
-->
   (<s> ^operator <o> +)
   (<o> ^name go-to-next-waypoint
        ^next-waypoint <next-wp>)
}

sp {go-to-waypoint*propose*go-to-next-waypoint*already*chosen
   (state <s> ^name go-to-waypoint
              ^current-action.next-waypoint <wp>)
-->
   (<s> ^operator <o> + >)
   (<o> ^name go-to-next-waypoint
        ^next-waypoint <wp>)
}

sp {go-to-waypoint*apply*go-to-next-waypoint*mark*next-waypoint
   (state <s> ^name go-to-waypoint
              ^operator <o>
              ^current-action <a>)
   (<o> ^name go-to-next-waypoint
        ^next-waypoint <wp>)
-->
   (<a> ^next-waypoint <wp>)
}

#sp {go-to-waypoint*propose*go-to-next-waypoint*no*current
#   (state <s> ^name go-to-waypoint
#              -^current-waypoint.next
#               ^distances <dists>
#               ^top-state.maps.map.waypoint <wp>)
#   (<dists> ^<wp-handle> <dist>)
#   -{ (<dists> ^<other> < <dist>) }
#   (<wp> ^handle <wp-handle>)
#-->
#   (<s> ^operator <o> +)
#   (<o> ^name go-to-next-waypoint
#        ^next-waypoint <wp>)
#}