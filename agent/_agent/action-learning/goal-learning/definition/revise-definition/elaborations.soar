sp {revise-definition*copy*goal-definition
   (state <s> ^name revise-definition
   	      ^superstate.operator <sop>)
   (<sop> ^purpose.details.goal-definition <gid>)
--> 
   (<s> ^goal-definition <gid>)
}

sp {revise-definition*elaborate*to-be-revised*predicates
   (state <s> ^name revise-definition
   	      ^superstate.operator.purpose.details <p>)
   (<p> ^predicate-grounding-failure <pred>)
-->
   (<s> ^predicate-grounding-failure <pred>)
}

sp {revise-definition*elaborate*map-id
   (state <s> ^name revise-definition 
   	      ^topstate.interaction.stack.segment.next.purpose.parameters.indexable.result <ia>)
   (<ia> ^_metadata <met>)
   (<met> ^map-id <map>)
-->
   (<s> ^map-id <map>
	^grounded-action <ia>)
}

sp {revise-definiton*elaborate*indexable
   (state <s> ^name revise-definition
   	      ^superstate.operator.purpose.parameters.indexable <index>)
-->
   (<s> ^indexable <index>)
}


sp {revise-definition*elaborate*new-goal
   (state <s> ^name revise-definition
   	      ^superstate.operator <sop>)
   (<sop> ^name revise-definition
   	  ^purpose.parameters.indexable.result <goal>)
-->
   (<s> ^grounded-goal <goal>)
}

sp {revise-definition*elaborate*generalizable*level1
   (state <s> ^name revise-definition
   	      ^grounded-goal <gg>
	      ^grounded-action <ga>)
   (<gg> ^<pred-type> <pred>)
   (<pred> ^<garg> <val>)
   (<ga> ^<aarg> <val>)
-->
   (<s> ^generalizable <gen>)
   (<gen> ^wmem-object <val>
   	  ^procedural-argument <aarg>
	  ^goal-argument <garg>
	  ^features <ft>
	  ^level one)
}

sp {revise-definition*elaborate*generalizable*level2*object
   (state <s> ^name revise-definition
   	      ^grounded-goal <gg>
	      ^grounded-action <ga>)
   (<gg> ^<pred-type> <pred>)
   (<pred> ^<garg> <val>)
   (<ga> ^<aarg>.<< argument >> <val>)
-->
   (<s> ^generalizable <gen>)
   (<gen> ^wmem-object <val>
   	  ^procedural-argument <aarg>
	  ^goal-argument <garg>
	  ^features <ft>
	  ^level two
	  ^type argument)
}

sp {revise-definition*elaborate*generalizable*level2*relation
   (state <s> ^name revise-definition
   	      ^grounded-goal <gg>
	      ^grounded-action <ga>)
   (<gg> ^<pred-type> <pred>)
   (<pred> ^<garg> <val>)
   (<ga> ^<aarg>.<< relation >> <val>)
-->
   (<s> ^generalizable <gen>)
   (<gen> ^wmem-object <val>
   	  ^procedural-argument <aarg>
	  ^goal-argument relation
	  ^level two
	  ^type relation)
}


# sp {revise-definition*elaborate*predicate*failure*grounded
#    (state <s> ^name revise-definition
#    	      ^predicate-grounding-failure <rp>
# 	      ^grounded-goal.<pred-type> <gg>)
#    (<rp> ^candidate-grounds <cg>
#    	 ^partial-grounds <pg>
# 	 ^predicate-type <pred-type>)
#    (<cg> ^<arg> <obj>)
#    (<gg> ^<arg> <obj>)
# -->
#    (<s> ^revise-predicate-definition <rpd>)
#    (<rpd> ^grounded-predicate <gg>
#    	  ^failure-details <rp>)
# }

sp {revise-definition*elaborate*predicate*failure*grounded
   (state <s> ^name revise-definition
   	      ^predicate-grounding-failure <rp>
	      ^grounded-goal.<pred-type> <gg>)
-->
   (<s> ^revise-predicate-definition <rpd>)
   (<rpd> ^grounded-predicate <gg>
   	  ^failure-details <rp>)
}
	  
sp {revise-definition*elaborate*predicate*failure*indexable
   (state <s> ^name revise-definition
   	      ^indexable <index>
	      ^revise-predicate-definition <rpd>)
   (<rpd> ^failure-details <f>)
   (<f> ^predicate-type <pred-type>)
   (<index> ^<arg> <val>)  
   (<val> ^type <pred-type>)
-->
   (<rpd> ^indexable <val>)
}


##### elaborate features for generalizable objects
# version 1
# sp {revise-definition*elaborate*features*generalizables*level1
#    (state <s> ^name revise-definition
#    	      ^generalizable <gen>
# 	      ^grounded-action._metadata.argument-attributes <attrs>)
#    (<attrs> ^<arg>.<attr> <val>)
#    (<gen> ^procedural-argument <arg>
#    	  ^features <ft>
# 	  ^level one)
# -->
#    (<ft> ^<attr> <val>)
# }

# sp {revise-definition*elaborate*features*generalizables*level2
#    (state <s> ^name revise-definition
#    	      ^generalizable <gen>
# 	      ^grounded-action._metadata.argument-attributes <attrs>)
#    (<attrs> ^<arg>.argument.<attr> <val>)
#    (<gen> ^procedural-argument <arg>
#    	  ^features <ft>
# 	  ^level two)
# -->
#    (<ft> ^<attr> <val>)
# }

# version 2
sp {revise-definition*elaborate*features*generalizables*level1
   (state <s> ^name revise-definition
   	      ^generalizable <gen>)
   (<gen> ^procedural-argument <arg>
   	  ^features <ft>
	  ^wmem-object.property <wprop>)
   (<wprop> ^label <val>	
   	    ^name <attr>)
-->
   (<ft> ^<attr> <val>)
}

# sp {revise-definition*elaborate*features*generalizables*relation
#    (state <s> ^name revise-definition
#    	      ^generalizable <gen>
# 	      ^grounded-action._metadata.argument-attributes <attrs>)
#    (<attrs> ^<arg>.argument.<attr> <val>)
#    (<gen> ^procedural-argument <arg>)
# -->
#    (<ft> ^<attr> <val>)
# }
